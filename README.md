# 智能辅助设计软件使用指南

## 目录
1. [简介](#1. 简介)
2. [软件文件架构说明](#2. 软件文件架构说明)
3. [标准操作流程](#3. 标准化操作流程（Standard Operating Procedure）)
4. [功能详解](#4. 功能详解)
    - [功能1：点位统计](#功能1：点位统计)
    - [功能2：系统图绘制](#功能2：系统图绘制)
5. [常见问题](#5. 常见问题)
6. [帮助](#6. 帮助)

## 1. 简介
欢迎使用 **智能辅助设计软件**。本指南旨在帮助用户快速掌握软件的基本操作和高级功能，提升设计效率。

本软件专为 **建筑智能化设计所** 发布的 `统一技术措施.dwg` 文件设计并优化。如果您使用了非标准文件或超出本指南规定范围的文件，可能会导致软件运行异常或报错。为确保软件正常运行，请严格按照指南要求操作。

## 2. 软件文件架构说明

本章节详细说明`IntellectualDesign.zip`解压后的文件目录结构与功能定位。如需进行统计文件维护或材料表更新，请仔细阅读本章内容。启动软件指引请参见第三章《标准操作流程》。

### 2.1 核心程序目录（/bin）

- **功能定位**：系统主程序及运行时依赖库存储目录
- **关键组件**：
  ▫ `OpenCADWPF.exe` - 主程序入口文件
  ▫ `IntellectualDesign.dll` - 核心功能模块
- **操作规范**：
  → 请通过双击`OpenCADWPF.exe`启动应用程序
  → 禁止修改/删除其他系统文件（可能导致功能异常）

### 2.2 输出文件目录

| 目录名称 | 文件生成逻辑 | 文件命名规范 |
|-------------------------|---------------------------------------|-----------------------------------|
| /MaterialTable | 执行"点位统计"后输出的材料表 | [序号]-[系统名称]-材料表.xlsx |
| /StatisticTable | 执行"点位统计"后生成的设备统计报表 | [序号]-[系统名称]-点位统计表.xlsx |

### 2.3 模板文件目录（/TemplateTable）

- **核心文件**：
  ▫ `4-出入口控制系统-材料表.xlsx` - 标准材料表模板
- **修改指引**：
  ① 建议保留原始模板备份
  ② 修改后需重启应用生效配置
  ③ 版本更新时注意模板兼容性

### 2.4 智能化设计模板库（/统一技术措施dwg模板）

包含 **建筑智能化研究所** 认证的标准化图纸模板：

1. **视频监控系统**
   `1-视频监控系统-20241216.dwg` 
2. **建筑设备监控系统**
   `2-建筑设备监控系统-20250210.dwg`
3. **信息发布系统**
   `3-信息发布系统-20250210.dwg`
4. **出入口控制系统**
   `4-出入口控制系统-20250210.dwg` 
5. **建筑能效监管系统**
   `5-建筑能效监管系统-20250115.dwg`
6. **会议系统**
   `6-会议系统-20250224.dwg` 

### 2.5 辅助文档

- **《智能辅助设计系统操作指南》**
  本技术白皮书包含：
  ✓ 系统架构解析
  ✓ 标准操作流程(SOP)
  ✓ 功能介绍
  ✓ 常见问题解决方案库
  （版本号：V1.1 发布日期：2025-2-25）

## 3. 标准化操作流程（Standard Operating Procedure）

### 3.1 系统初始化

**步骤 3.1.1** 启动主程序
› 定位至`/bin`程序目录
› 双击`OpenCADWPF.exe` → 运行主程序

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308012152226.png" alt="image-20250308012152226" style="zoom:60%;" />

**步骤 3.1.2** 安全认证处理（首次启动）
› 当Windows Defender SmartScreen触发"Unrecognized app"警报：
① 选择`More info（更多信息）` → 点击`Run anyway（仍然运行）`
② 在UAC提示中选择`是`授权执行

**步骤 3.1.3** 环境配置
› 在启动器界面选择符合本地环境的CAD版本（建议AutoCAD 2019及以上）
› 首次加载时出现弹窗`安全性 - 未签名的可执行文件` 
▸ 点击`始终加载` 

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308012650734.png" alt="image-20250308012650734" style="zoom:50%;" />

### 3.2 核心功能操作

**步骤 3.2.1** 功能模块激活
› 在AutoCAD功能区面板(RibbonTab)中：
① 选择选项 → `智能化系统辅助设计`

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308012903419.png" alt="image-20250308012903419" style="zoom:67%;" />

**步骤 3.2.2** 系统配置
› 在功能区中：
① 下拉`系统类型`选择器
② 选择目标系统（如：出入口控制系统）

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308013048429.png" alt="image-20250308013048429" style="zoom:67%;" />

**步骤 3.2.3** 点位统计
› 执行`点位统计`指令流程：
① 点击交互界面的`选择`按钮，鼠标点选统计边界

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308013142615.png" alt="image-20250308013142615" style="zoom:50%;" />

② 填写该统计区域信息，重复操作①、②直至统计结束

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308013449026.png" alt="image-20250308013449026" style="zoom:67%;" />

③ 点击`导出点位统计表`按钮执行导出点位统计表命令，在交互界面中指定文件保存路径。若无指定，系统输出文件自动归档至预定目录 `\StatisticTable`  （详见2.2节)

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308013725326.png" alt="image-20250308013725326" style="zoom: 50%;" />

④ 点击`导出材料表`按钮执行导出材料表命令，在交互界面中指定文件保存路径。若无指定，系统输出文件自动归档至预定目录 `\MaterialTable`  （详见2.2节)。**注意！此步骤会读取步骤③中导出的点位统计表，请保证点位统计表的名称及文件路径在执行步骤④前不要改变** 

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308013815823.png" alt="image-20250308013815823" style="zoom:50%;" />

⑤ 点击`完成` 退出点位统计功能

**步骤 3.2.4** 系统图绘制
› 执行`系统图绘制`指令流程：
① 通过交互界面选择点位统计表

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308014034747.png" alt="image-20250308014034747" style="zoom:67%;" />

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308014116039.png" alt="image-20250308014116039" style="zoom:67%;" />

② 鼠标点选绘图基点

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308014148600.png" alt="image-20250308014148600" style="zoom:67%;" />

③ 系统图绘制完成，保存文件

<img src="C:\Users\GunsNFloyd\AppData\Roaming\Typora\typora-user-images\image-20250308014205367.png" alt="image-20250308014205367" style="zoom: 50%;" />

## 4. 功能详解

### 功能1：点位统计

* **适用系统**（全系统）

  * 1-视频监控系统
  * 2-建筑设备监控系统
  * 3-信息发布系统
  * 4-出入口控制系统
  * 5-建筑能效监管系统
  * 6-会议系统

* **操作步骤**

  1. 在 **“[系统名称]-点位统计”** 对话框中，点击右下角的 **“选择”** 按钮，根据屏幕提示选择一个多段线区域。系统将自动统计该区域内所有与 xx 系统相关的设备名称、编号及数量。

  2. 手动填写步骤1中选择区域的楼层信息和弱电间信息，同时确保每一层楼都至少填写一个弱电间。操作技巧如下：

      * **无需逐行填写**，系统会自动补全空白单元格，示例如下。
      * **新选择的数据** 会在表格中加粗显示。
      * 若需要 **删除某一行数据**，左键选中该行，再右键该行前三列任意区域，点击“删除”即可。
      * 若需要 **删除多行数据**，则左键选中起始行，按住shift左键选中结束行，再右键选择区域的前三列任意区域，点击“删除”即可。
      
  
  
  3. 点击对话框右下角的 **“导出点位统计表和材料表”** 按钮，系统将在`/StatisticTable` 文件夹内生成默认名称为 `[序号]-[系统名称]-点位统计表.xlsx` 的点位统计表文件，并在 `/MaterialTable` 文件夹内生成默认名称为`[序号]-[系统名称]-材料表.xlsx`的材料表文件。
  
       （注：若您正在使用的是**2-建筑设备监控系统**，这一步还将额外生成一个默认名称为`2-建筑设备监控系统-点位总表.xlsx`的点位总表文件）
  
  4. 点击 **“保存”** 后，若出现成功提示弹窗，则表示文件已成功导出。最后，点击 **“完成”** 退出“点位统计”功能。
  


### 功能2：系统图绘制

* **适用系统**（全系统）

  * 1-视频监控系统
  * 2-建筑设备监控系统
  * 3-信息发布系统
  * 4-出入口控制系统
  * 5-建筑能效监管系统
  * 6-会议系统

* **操作步骤**

  1. 在 **“xx系统-系统图绘制”** 对话框中，点击下方 **“打开”** 按钮，选择相同系统的 **点位统计** 功能生成的点位统计表文件。

  2. 点击 **“确定”** 按钮。等待一段时间后系统提示“请选择图像绘制基点”，如下图所示。

  3. **鼠标点选** 绘图基点系统后将生成系统图。生成系统图样例如下图所示。


## 5. 常见问题

### 点位统计功能相关问题

**[系统无法正确统计我的平面图上的图块，如何解决？]**

* 软件 **“点位统计”** 功能需要保证软件统计的图块均为 `统一技术措施.dwg` 文件中包含的标准图块。若存在 **自定义图块** 或 **未成图块 **的统计对象可能导致软件统计不完全，需要在 `[序号]-[系统名称]-点位统计表.xlsx` 文件中自行添加。

**[我需要修改统计表的部分数据，但不想重新统计一遍，怎么办？]**

* 软件 **“点位统计”** 功能生成的 `[序号]-[系统名称]-点位统计表.xlsx` 统计表为独立的Excel文件，记录了您在使用软件时统计的所有控件信息，因此如有修改部分数据的需求，可直接在生成的统计表中进行修改。

### 系统图绘制功能相关问题

**[系统图绘制时报错，如何解决？]**

* 软件 **“系统图绘制”** 功能需在 `统一技术措施.dwg` 文件或其副本中使用。若使用其他文件，可能会导致图块缺失、绘图不完整或文字乱码等问题。
* 在使用前，请检查 `[序号]-[系统名称]-点位统计表.xlsx` 文件的 **Sheet2** 中是否存在单元格合并或数据遗漏问题，以确保数据完整性。

**[我更新了我的图块数据库，如何让软件也进行更新迭代？]**

* 手动更新图块并进行标准化命名。具体操作步骤如下：
  1. **读取平面图块属性值**：
     - 双击需要更新的图块对应的 **平面图块**，打开其增强属性编辑器。
     - 复制标记为“A”的属性值。
  2. **更新系统图块**：
     - 双击需要更新的 **系统图块**，编辑块定义。
     - 粘贴上一步复制的字符串，并删除前缀（如“5-能效监管-”），仅保留图块名称（如“数字电表”）。

## 6. 帮助

如果您在使用过程中遇到问题，可以通过以下方式获取支持：
- 发送邮件至：vbv579971@163.com
- 拨打开发人员电话：15808757193
